<!-- Google AdSense Verification -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1969420529082920"
  crossorigin="anonymous"></script>

<!-- Google Funding Choices (CMP for GDPR/Privacy Consent) -->
<script async src="https://fundingchoicesmessages.google.com/i/pub-1969420529082920?ers=1"
  nonce="FUNDING-CHOICES-NONCE"></script>
<script
  nonce="FUNDING-CHOICES-NONCE">(function () { function signalGooglefcPresent() { if (!window.frames['googlefcPresent']) { if (document.body) { const iframe = document.createElement('iframe'); iframe.style = 'width: 0; height: 0; border: none; z-index: -1000; left: -1000px; top: -1000px;'; iframe.style.display = 'none'; iframe.name = 'googlefcPresent'; document.body.appendChild(iframe); } else { setTimeout(signalGooglefcPresent, 0); } } } signalGooglefcPresent(); })();</script>

<!-- Theme Toggle Script -->
<script>
  (function () {
    const updateButtonIcons = (theme) => {
      const icons = { auto: 'üåì', dark: '‚òÄÔ∏è', light: 'üåô' };
      const icon = icons[theme] || icons.auto;
      
      // Update mobile button (in header) - handled by CSS ::before
      
      // Update desktop button (in TOC)
      const desktopIcon = document.getElementById('theme-icon-desktop');
      if (desktopIcon) {
        desktopIcon.textContent = icon;
      }
      
      // Update menu button (always visible)
      const menuIcon = document.getElementById('theme-icon-menu');
      if (menuIcon) {
        menuIcon.textContent = icon;
      }
    };    const applyTheme = (theme) => {
      const root = document.documentElement;
      if (theme === 'dark') {
        root.classList.add('dark-theme');
        root.classList.remove('light-theme');
      } else if (theme === 'light') {
        root.classList.add('light-theme');
        root.classList.remove('dark-theme');
      } else {
        root.classList.remove('dark-theme', 'light-theme');
      }
      updateButtonIcons(theme);
    };

    const savedTheme = localStorage.getItem('theme') || 'auto';
    applyTheme(savedTheme);

    window.toggleTheme = () => {
      const current = localStorage.getItem('theme') || 'auto';
      const newTheme = current === 'auto' ? 'dark' : current === 'dark' ? 'light' : 'auto';
      localStorage.setItem('theme', newTheme);
      applyTheme(newTheme);
    };

    // Update icons when DOM is ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', () => updateButtonIcons(savedTheme));
    } else {
      updateButtonIcons(savedTheme);
    }
  })();
</script>

<style>
  html.dark-theme {
    color-scheme: dark;
    --body-background: #1e1e1e;
    --body-font-color: #e0e0e0;
    --color-link: #84b2ff;
    --color-visited-link: #b993ff;
  }

  html.dark-theme .book-menu,
  html.dark-theme .book-toc,
  html.dark-theme .book-header,
  html.dark-theme .book-footer {
    background: #252525;
  }

  html.dark-theme .book-page {
    background: #1e1e1e;
  }

  html.dark-theme .markdown {
    color: #e0e0e0;
  }

  html.dark-theme .markdown code {
    background: #2d2d2d;
    color: #f0f0f0;
  }

  html.dark-theme .markdown pre {
    background: #2d2d2d;
  }

  html.dark-theme .markdown table tr:nth-child(2n) {
    background: #252525;
  }

  /* Wide layout - remove max-width constraint and make sidebars fixed width */
  .container {
    max-width: none !important;
    margin: 0 !important;
  }

  /* Fix sidebar widths and positions */
  .book-menu {
    position: fixed;
    left: 0;
    width: 16rem;
  }

  .book-toc {
    position: fixed;
    right: 0;
    width: 16rem;
  }

  /* Adjust main content area to fill space between sidebars */
  .book-page {
    margin-left: 16rem;
    margin-right: 16rem;
    max-width: none;
    padding: 1rem 2rem;
  }

  /* On mobile, revert to default behavior */
  @media screen and (max-width: 56rem) {

    .book-menu,
    .book-toc {
      position: static;
      width: auto;
    }

    .book-page {
      margin-left: 0;
      margin-right: 0;
      padding: 1rem;
    }
  }

  #theme-toggle {
    cursor: pointer;
    border: 1px solid rgba(128, 128, 128, 0.3);
    background: rgba(128, 128, 128, 0.1);
    padding: 0.5rem 0.75rem;
    font-size: 1.2rem;
    border-radius: 4px;
    transition: all 0.2s;
    margin-right: 0.5rem;
  }

  #theme-toggle:hover {
    background: rgba(128, 128, 128, 0.2);
    border-color: rgba(128, 128, 128, 0.5);
  }

  #theme-toggle::before {
    content: 'üåô';
  }

  html.dark-theme #theme-toggle::before {
    content: '‚òÄÔ∏è';
  }

  html.light-theme #theme-toggle::before {
    content: 'üåô';
  }

  /* Theme toggle buttons styling */
  #theme-toggle-desktop,
  #theme-toggle-menu {
    width: 100%;
    cursor: pointer;
    border: 1px solid rgba(128, 128, 128, 0.3);
    background: rgba(128, 128, 128, 0.1);
    padding: 0.5rem;
    font-size: 1.2rem;
    border-radius: 4px;
    transition: all 0.2s;
  }

  #theme-toggle-desktop:hover,
  #theme-toggle-menu:hover {
    background: rgba(128, 128, 128, 0.2);
    border-color: rgba(128, 128, 128, 0.5);
  }
</style>